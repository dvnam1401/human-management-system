@page
@model human_management_system_fe.Pages.Profile.IndexModel
@{
    ViewData["Title"] = "Thông tin cá nhân";
}

<div class="row">
    <div class="col-md-8 mx-auto">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2><i class="bi bi-person-circle me-2"></i>Thông tin cá nhân</h2>
            <a href="/Index" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-1"></i>Quay lại
            </a>
        </div>

        <!-- Error State -->
        @if (!string.IsNullOrEmpty(Model.ErrorMessage))
        {
            <div class="alert alert-danger">
                <i class="bi bi-exclamation-triangle me-2"></i>
                <span>@Model.ErrorMessage</span>
            </div>
        }

        <!-- Profile Card -->
        @if (Model.Profile != null)
        {
        <div id="profileCard">
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-body p-4">
                    <!-- Avatar and Name -->
                    <div class="text-center mb-4">
                        <div class="avatar-large mb-3">
                            <i class="bi bi-person-circle text-primary"></i>
                        </div>
                        <h3 class="mb-1">
                            @(!string.IsNullOrEmpty(Model.Profile.FullName) 
                                ? Model.Profile.FullName 
                                : $"{Model.Profile.FirstName} {Model.Profile.LastName}".Trim())
                        </h3>
                        <span class="badge bg-primary">@(Model.Profile.Role ?? "Employee")</span>
                        <span class="badge @(Model.Profile.IsActive ? "bg-success" : "bg-danger") ms-2">
                            @(Model.Profile.IsActive ? "Đang hoạt động" : "Không hoạt động")
                        </span>
                    </div>

                    <hr>

                    <!-- User Information -->
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="info-item">
                                <label class="text-muted small mb-1">
                                    <i class="bi bi-person me-1"></i>Username
                                </label>
                                <div class="fw-semibold">@Model.Profile.Username</div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="info-item">
                                <label class="text-muted small mb-1">
                                    <i class="bi bi-envelope me-1"></i>Email
                                </label>
                                <div class="fw-semibold">@Model.Profile.Email</div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="info-item">
                                <label class="text-muted small mb-1">
                                    <i class="bi bi-telephone me-1"></i>Số điện thoại
                                </label>
                                <div class="fw-semibold">@(Model.Profile.PhoneNumber ?? "Chưa cập nhật")</div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="info-item">
                                <label class="text-muted small mb-1">
                                    <i class="bi bi-calendar me-1"></i>Ngày sinh
                                </label>
                                <div class="fw-semibold">
                                    @(Model.Profile.DateOfBirth?.ToString("dd/MM/yyyy") ?? "Chưa cập nhật")
                                </div>
                            </div>
                        </div>

                        @if (!string.IsNullOrEmpty(Model.Profile.Address))
                        {
                        <div class="col-md-12">
                            <div class="info-item">
                                <label class="text-muted small mb-1">
                                    <i class="bi bi-geo-alt me-1"></i>Địa chỉ
                                </label>
                                <div class="fw-semibold">@Model.Profile.Address</div>
                            </div>
                        </div>
                        }
                    </div>
                </div>
            </div>

            <!-- Employee Information (if applicable) -->
            @if (Model.Profile.EmployeeId.HasValue || Model.Profile.DepartmentId.HasValue)
            {
            <div class="card shadow-sm border-0">
                <div class="card-header bg-white">
                    <h5 class="mb-0">
                        <i class="bi bi-briefcase me-2"></i>Thông tin nhân viên
                    </h5>
                </div>
                <div class="card-body p-4">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="info-item">
                                <label class="text-muted small mb-1">
                                    <i class="bi bi-building me-1"></i>Phòng ban
                                </label>
                                <div class="fw-semibold">@(Model.Profile.DepartmentName ?? "Chưa phân công")</div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="info-item">
                                <label class="text-muted small mb-1">
                                    <i class="bi bi-calendar-check me-1"></i>Ngày vào làm
                                </label>
                                <div class="fw-semibold">
                                    @(Model.Profile.HireDate?.ToString("dd/MM/yyyy") ?? "N/A")
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="info-item">
                                <label class="text-muted small mb-1">
                                    <i class="bi bi-cash me-1"></i>Lương
                                </label>
                                <div class="fw-semibold">
                                    @(Model.Profile.Salary.HasValue 
                                        ? Model.Profile.Salary.Value.ToString("N0") + " VNĐ"
                                        : "N/A")
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="info-item">
                                <label class="text-muted small mb-1">
                                    <i class="bi bi-clock-history me-1"></i>Ngày tạo tài khoản
                                </label>
                                <div class="fw-semibold">@Model.Profile.CreatedAt.ToString("dd/MM/yyyy")</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            }
        </div>
        }
        else if (string.IsNullOrEmpty(Model.ErrorMessage))
        {
            <div class="text-center py-5">
                <i class="bi bi-person-x text-muted" style="font-size: 4rem;"></i>
                <p class="mt-3 text-muted">Không tìm thấy thông tin cá nhân</p>
            </div>
        }
    </div>
</div>

@section Scripts {
    <style>
        .avatar-large {
            font-size: 6rem;
        }

        .info-item {
            padding: 0.75rem;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .card {
            border-radius: 12px;
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .badge {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }
    </style>
}

